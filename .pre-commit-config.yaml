---
# SPDX-License-Identifier: Apache-2.0
# SPDX-FileCopyrightText: 2025 The Linux Foundation

ci:
  skip: [pytest, markdown-table-fixer]
  autofix_commit_msg: |
    Chore: pre-commit autofixes

    Signed-off-by: pre-commit-ci[bot] <pre-commit-ci@users.noreply.github.com>
  autoupdate_commit_msg: |
    Chore: pre-commit autoupdate

    Signed-off-by: pre-commit-ci[bot] <pre-commit-ci@users.noreply.github.com>

repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: 3e8a8703264a2f4a69428a0aa4dcb512790b2c8c # frozen: v6.0.0
    hooks:
      - id: trailing-whitespace
      - id: check-added-large-files
      - id: check-ast
      - id: check-json
      - id: check-merge-conflict
      - id: check-xml
      - id: check-yaml
      - id: debug-statements
      - id: end-of-file-fixer
      - id: requirements-txt-fixer
      - id: mixed-line-ending
        args: ["--fix=lf"]
      - id: no-commit-to-branch
        args:
          - --branch=dev
          - --branch=master
          - --branch=main
          - --branch=rc
          - --branch=production

  - repo: https://github.com/jorisroovers/gitlint
    rev: acc9d9de6369b76d22cb4167029d2035e8730b98 # frozen: v0.19.1
    hooks:
      - id: gitlint

  - repo: https://github.com/adrienverge/yamllint.git
    rev: cba56bcde1fdd01c1deb3f945e69764c291a6530  # frozen: v1.38.0
    hooks:
      - id: yamllint
        types: [yaml]

  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: 45ef068da5f21267bb2a7ec4a623092959f09ce5  # frozen: v0.14.14
    hooks:
      - id: ruff
        args: [--fix, --exit-non-zero-on-fix]
      - id: ruff-format

  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: a66e98df7b4aeeb3724184b332785976d062b92e  # frozen: v1.19.1
    hooks:
      - id: mypy
        additional_dependencies:
          - typer>=0.15.0
          - rich>=13.9.4
          - httpx[http2]>=0.28.0
          - pydantic>=2.10.3
          - aiolimiter>=1.2.0
          - tenacity>=9.0.0
          - wcwidth>=0.2.13
          - pyyaml>=6.0.0
          - types-PyYAML>=6.0.0

  - repo: https://github.com/btford/write-good
    rev: ab66ce10136dfad5146e69e70f82a3efac8842c1 # frozen: v1.0.8
    hooks:
      - id: write-good
        args: ["--no-adverb"]
        files: "\\.(rst|md|markdown|mdown|mkdn)$"
        exclude: |
          (?x)^(
            CHANGELOG\.md|
            IMPLEMENTATION_COMPLETE\.md|
            IMPLEMENTATION_SUMMARY\.md|
            SETUP\.md|
            FEATURES\.md|
            CONTRIBUTING\.md|
            PROJECT_SUMMARY\.md|
            EMOJI_TESTING\.md|
            examples/bad_tables\.md|
            examples/emoji_tables\.md|
            tests/README\.md
          )$

  - repo: https://github.com/shellcheck-py/shellcheck-py
    rev: 745eface02aef23e168a8afb6b5737818efbea95 # frozen: v0.11.0.1
    hooks:
      - id: shellcheck

  - repo: https://github.com/igorshubovych/markdownlint-cli
    rev: 76b3d32d3f4b965e1d6425253c59407420ae2c43  # frozen: v0.47.0
    hooks:
      - id: markdownlint
        args: ["--fix"]

  - repo: https://github.com/fsfe/reuse-tool
    rev: 9fabf9eb815a57aac116b435e8346c200cdb8604  # frozen: v6.2.0
    hooks:
      - id: reuse

  # Check for misspellings in documentation files
  - repo: https://github.com/codespell-project/codespell
    rev: 63c8f8312b7559622c0d82815639671ae42132ac # frozen: v2.4.1
    hooks:
      - id: codespell

  - repo: https://github.com/lfreleng-actions/gha-workflow-linter
    rev: a7caf8f3a1a05688d1cee46615ff94def617e5a3  # frozen: v1.0.2
    hooks:
      - id: gha-workflow-linter
        args: [lint, .github/workflows/, --verbose, --no-auto-fix]

  # Markdown table fixer (local development version)
  - repo: local
    hooks:
      - id: markdown-table-fixer
        name: Markdown Table Fixer
        description: Fix markdown table formatting issues
        entry: >-
          bash -c
          'for file in "$@"; do
          markdown-table-fixer lint "$file" --auto-fix || exit 1;
          done' --
        language: system
        files: '\.md$'
        exclude: |
          (?x)^(
            examples/(bad_tables|emoji_tables)\.md|
            EMOJI_TESTING\.md|
            FEATURES\.md|
            IMPLEMENTATION_COMPLETE\.md|
            PROJECT_SUMMARY\.md|
            README\.md|
            scripts/README\.md
          )$
        pass_filenames: true
        require_serial: true

  # Run tests last to ensure all code changes from other hooks are tested
  - repo: local
    hooks:
      - id: pytest
        name: pytest
        entry: uv
        args: [run, pytest, --tb=short, -q, -x, --no-cov]
        language: system
        pass_filenames: false
        always_run: true
